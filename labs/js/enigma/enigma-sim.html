<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
<head>
<title>Enigma Machine Simulator</title>
<script src="namespace.js"></script>
<script src="base.js"></script>
<script src="formatutil.js"></script>
<script src="dom.js"></script>
<script src="events.js"></script>
<script src="enigma.js"></script>
<link rel="stylesheet" type="text/css" href="enigma-sim.css"/>
<script>
/*
	Web UI for the Enigma machine simulator.
	
	Copyright (c) 2009, Mike Koss - mckoss@startpad.org
*/
var Sim = global_namespace.Define('startpad.enigma.sim', function (NS) {
	var Enigma = global_namespace.Import('startpad.enigma');
	var machine = new Enigma.Enigma();
	var DOM = global_namespace.Import('startpad.DOM');
	var Event = global_namespace.Import('startpad.events');
	
Enigma.fnTrace = function(s) {console.log(s);}

NS.Extend(NS, {
Init: function()
	{
	NS.mParts = DOM.BindIDs();
	NS.mParts.plain.focus();
	
	Event.AddEventFn(NS.mParts.plain, 'change', NS.UpdateDisplay);
	Event.AddEventFn(NS.mParts.plain, 'keydown', function(){});
	Event.AddEventFn(NS.mParts.plain, 'keyup', function(evt)
		{
		NS.UpdateDisplay();
		});
	
	NS.UpdateDisplay();
	},
	
UpdateDisplay: function()
	{
	var sPlain = NS.mParts.plain.value;
	machine.Init();
	var sCipher = machine.Encode(sPlain);
	DOM.SetText(NS.mParts.cipher, sCipher);
	}

});
});

</script>
</head>
<body>
<div class="page">
<h1><script>document.write(document.title);</script></h1>
<textarea id="plain"></textarea>
<div id="cipher"></div>
</div>
<script>Sim.Init();</script>
</body>
</html>
